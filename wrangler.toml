# 项目名称（保持你原有的 'rssw'）
name = "rssw"

# 兼容 Cloudflare Workers/Pages 运行时
compatibility_date = "2024-02-01"

# 运行时配置（关键：解决 cloudflare:sockets 等模块兼容问题）
compatibility_flags = [
  "nodejs_compat",        # 启用 Node.js 兼容模式
  "service_binding",      # 服务绑定（可选）
  "websockets"            # 启用 WebSocket（RSSHub 部分功能需要）
]

# 构建配置（适配 RSSHub 构建）
[build]
command = "npm run build"  # 构建命令
cwd = "."                  # 构建工作目录
watch_dir = "src"          # 监听源码目录

# Pages 部署配置（关键：适配 Pages 运行时）
[pages]
entry-point = "dist/index.js"  # 构建输出入口文件
bucket_name = ""               # 若需要绑定 R2 存储桶可填写
persist = false                # 禁用持久化（Pages 不支持）

# 环境变量（按需添加，解决依赖和运行时问题）
[vars]
NODE_ENV = "production"
CACHE_TYPE = "memory"
ALLOW_LOCALHOST = "true"
ESBUILD_EXTERNAL = "cloudflare:sockets"  # 排除无法解析的模块

# 网络配置（解决 RSSHub 网络请求问题）
[limits]
memory = 128                  # 内存限制（Pages 免费版最大 128MB）
cpu = 100                     # CPU 时间限制
timeout = 30                  # 请求超时时间（秒）

# 日志配置（方便调试）
[logs]
level = "info"                # 日志级别
retention = "7d"              # 日志保留时间
